<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Painel TV</title>
    <style>
        body { margin: 0; background: black; color: white; font-family: sans-serif; overflow: hidden; }
        
        /* Centraliza tudo */
        .container { display: flex; justify-content: center; align-items: center; height: 100vh; flex-direction: column; }

        /* Tela de bloqueio para liberar √°udio */
        #overlay-bloqueio {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 9999;
            display: flex; justify-content: center; align-items: center; flex-direction: column;
        }
        
        button.btn-iniciar { padding: 25px 50px; font-size: 30px; background: #28a745; color: white; border: none; border-radius: 15px; cursor: pointer; }
        
        h1 { font-size: 4rem; text-align: center; }
    </style>
</head>
<body>

    <div id="overlay-bloqueio">
        <h1>‚ö†Ô∏è SISTEMA DE SORTEIO</h1>
        <p style="font-size: 20px; margin-bottom: 30px;">Clique no bot√£o abaixo para ativar o som da TV</p>
        <button class="btn-iniciar" onclick="liberarAudioTV()">ATIVAR PAINEL üîä</button>
    </div>

    <div class="container">
        <h1 id="texto-status">Aguardando...</h1>
    </div>

    <audio id="somTV" src="vitoria.mp3"></audio>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        const audio = document.getElementById('somTV');
        const overlay = document.getElementById('overlay-bloqueio');
        const texto = document.getElementById('texto-status');
        let audioLiberado = false;

        // 1. Fun√ß√£o que destrava o som (chamada pelo bot√£o verde)
        function liberarAudioTV() {
            audio.play().then(() => {
                audio.pause();
                audio.currentTime = 0;
                audioLiberado = true;
                overlay.style.display = 'none'; // Some com a tela de bloqueio
            }).catch(e => alert("Erro ao liberar √°udio: " + e));
        }

        // 2. Recebe o comando do celular
        socket.on('tocar_na_tv', () => {
            
            // Muda o texto
            texto.innerText = "üéâ TEMOS UM GANHADOR! üéâ";
            texto.style.color = "#ffff00";

            // Toca o som (Se j√° tiver sido liberado antes)
            if (audioLiberado) {
                audio.currentTime = 0;
                audio.play();
            }

            // Reseta depois de 5 segundos
            setTimeout(() => {
                texto.innerText = "Aguardando...";
                texto.style.color = "white";
            }, 5000);
        });
    </script>
</body>
</html>
